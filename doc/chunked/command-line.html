<html><head><meta http-equiv="Content-Type" content="text/html; charset="><title>Приложение A. Описание параметров командной строки</title><link rel="stylesheet" href="screen.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="ardj"><link rel="up" href="index.html" title="ardj"><link rel="prev" href="listening-statistics.html" title="Получение статистики"><link rel="next" href="jabber-commands.html" title="Приложение B. Описание команд jabber-бота"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Приложение A. Описание параметров командной строки</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="listening-statistics.html">Пред.</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="jabber-commands.html">След.</a></td></tr></table><hr></div><div class="appendix" title="Приложение A. Описание параметров командной строки"><div class="titlepage"><div><div><h2 class="title"><a name="command-line"></a>Приложение A. Описание параметров командной строки</h2></div></div></div><p>Интерфейс ко всем функциям предоставляет программа <span class="command"><strong>ardj</strong></span>.  Эта программа первым параметром
    принимает имя команды, которое может сопровождаться дополнительными параметрами.  Все команды и возможные параметры
    описаны в этом разделе.</p><p>При использовании оболочек <span class="command"><strong>bash</strong></span> и <span class="command"><strong>zsh</strong></span> работает автодополнение команд и
    параметров, можно использовать кнопку TAB для ускоренного набора.</p><div class="variablelist"><dl><dt><a name="cli-add-incoming"></a><span class="term"><code class="option">add-incoming-tracks</code></span></dt><dd><p>Ищет файлы в папке, указанной в параметре <code class="option">incoming_path</code> конфигурационного файла.  Все
          найденные файлы с расширениями <code class="filename">.mp3</code> и <code class="filename">.ogg</code> перемещаются в медиатеку
          и удаляются.  Если файл не может быть удалён — он игнорируется (чтобы не добавлять его повторно при каждом
          последующем вызове).</p><p>Эта команда является эквивалентом команды <span class="command"><strong>upload</strong></span> джаббера.</p></dd><dt><span class="term"><code class="option">config</code></span></dt><dd><p>Запускает текстовый редактор с открытым для редактирования конфигурационным файлом.</p></dd><dt><span class="term"><code class="option">console [jid]</code></span></dt><dd><p>Открывает интерактивную консоль, эмулирующую общение через джаббер (только без джаббера и вообще без
          использования сети).  Эта функция полезна для отладки, например, когда пользователь жалуется на неожиданное
          поведение команды, которое не воспроизводится у других пользователей.</p></dd><dt><span class="term"><code class="option">db-console</code></span></dt><dd><p>Открывает интерактивную консоль для работы с базой данных, SQLite или MySQL.  Может использоваться в
          скриптах (запросы надо передавать через stdin).</p></dd><dt><span class="term"><code class="option">db-init</code></span></dt><dd><p>Инициализация недостающих таблиц и индексов базы данных.  Эта процедура обычно выполняется при установке
          пакета и больше не нужна.  Выполнить её вручную может понадобиться, например, если вы случайно уничтожили базу
          данных и хотите начать сначала.</p></dd><dt><span class="term"><code class="option">db-purge</code></span></dt><dd><p>Удаляет из базы данных мусор, вроде неиспользуемых меток и файлов, относящихся к дорожкам, которые были
          удалены.</p></dd><dt><span class="term"><code class="option">db-stats</code></span></dt><dd><p>Показывает информацию о количестве композиций и их суммарной продолжительности, например: "2883 tracks,
          192.0 hours".</p></dd><dt><span class="term"><code class="option">download-artist name</code></span></dt><dd><p>Сохраняет запрос на загрузку песен указанного исполнителя.  Сама загрузка выполняется позже, в фоновом
          режиме.</p><p>Эта команда является эквивалентом команды <span class="command"><strong>download</strong></span> джаббера.</p></dd><dt><a name="cli-export-total"></a><span class="term"><code class="option">export-total-listeners</code></span></dt><dd><p>Выводит в stdout общую <a class="link" href="listening-statistics.html" title="Получение статистики">статистику прослушиваний</a>.</p></dd><dt><a name="cli-export-yesterday"></a><span class="term"><code class="option">export-yesterday-listeners</code></span></dt><dd><p>Выводит в stdout подробную <a class="link" href="listening-statistics.html" title="Получение статистики">статистику прослушиваний</a> за
          последние сутки.</p></dd><dt><span class="term"><code class="option">find-new-tracks</code></span></dt><dd><p>Запускает поиск новой музыки.  Сначала выбираются исполнители, имеющие дорожки с оценками выше средней,
          затем в Last.fm и Jamendo ищется новая музыка этих исполнителей, которую позволено скачивать.</p></dd><dt><span class="term"><code class="option">fix-artist-names</code></span></dt><dd><p>Проверяет имя исполнителя по базе данных Last.fm и исправляет, если сервер рекомендует это.  Обычно это
          приводит к изменению регистра, но может и полностью заменить имя, например, исправив ложную
          транслитерацию.</p></dd><dt><span class="term"><code class="option">help</code></span></dt><dd><p>Выводит краткую сводку по поддерживаемым командам.</p></dd><dt><span class="term"><code class="option">mark-hitlist</code></span></dt><dd><p>Отмечает примерно десяток лучших песен меткой "hitlist".  Реальное количество дорожек обычно чуть
          больше, потому что отмечаются все дорожки с рейтингом не ниже десятой по счёту (то есть на десятом месте может
          быть несколько дорожек).</p><p>Если настроено взаимодействие с Last.fm, отмеченные дорожки добавляются в «любимые».</p></dd><dt><span class="term"><code class="option">mark-liked-by label jid1 jid2 ...</code></span></dt><dd><p>Отмечает меткой "label" композиции, которые нравятся всем указанным пользователям.  Эту команду можно
          использовать для создания специфической атмосферы перед прямыми включениями, когда известны будущие
          участники.</p></dd><dt><span class="term"><code class="option">mark-long</code></span></dt><dd><p>Отмечает меткой "long" композиции с продолжительностью выше средней.  Можно использовать метку для
          исключения слишком длинных песен из дневной ротации.</p></dd><dt><span class="term"><code class="option">mark-orphans</code></span></dt><dd><p>Отмечает меткой "orphan" композиции, не находящиеся ни в одном плейлисте.</p></dd><dt><span class="term"><code class="option">merge-votes</code></span></dt><dd><p>Склеивает голоса пользователей в соответствии со значением параметра <code class="option">jabber_aliases</code>
          конфигурационного файла.</p></dd><dt><span class="term"><code class="option">queue-flush</code></span></dt><dd><p>Очищает <a class="link" href="queue.html" title="Управление очередью (заказы)">очередь заказов</a>.</p></dd><dt><span class="term"><code class="option">scan-replaygain [files...]</code></span></dt><dd><p>Запускает сканирование ReplayGain для всех файлов, у которых нет нужной информации.  Если параметр
          <code class="option">files</code> не указан — сканирует все файлы в медиатеке.</p><p>Для сканирования используются программы <span class="command"><strong>mp3gain</strong></span> и
          <span class="command"><strong>vorbisgain</strong></span>.</p></dd><dt><span class="term"><code class="option">serve</code></span></dt><dd><p>Запускает веб-сервер для доступа к Web API.  Сервер обычно доступен по адресу localhost:8080, но этот
          адрес может быть изменён параметром <code class="option">api_socket</code> конфигурационного файла.  Сервер используется
          плагином для <span class="command"><strong>ices</strong></span> и некоторыми командами джаббера.</p><p>Запускать сервер вручную может понадобиться только в отладочных целях.  В повседневной работе его
          запускает системная служба, ещё это можно сделать командой <span class="command"><strong>sudo start ardj-server</strong></span> (по
          умолчанию команда доступна без пароля всем пользователям из группы "ardj").</p></dd><dt><span class="term"><code class="option">tags files...</code></span></dt><dd><p>Выводит содержимое поддерживаемых тэгов.  Эта функция обычно используется в отладочных целях, чтобы
          убедиться в работоспособности функции чтения тэгов и в корректности самих тэгов.  Для работы используется
          библиотека <a class="ulink" href="http://code.google.com/p/mutagen/" target="_top">python-mutagen</a>.</p></dd><dt><span class="term"><code class="option">twit "text..."</code></span></dt><dd><p>Отправляет указанный текст в Твиттер.  Работает только при корректном заполнении параметра
          <code class="option">twitter</code> конфигурационного файла, в противном случае пишет что делать.</p></dd><dt><span class="term"><code class="option">twit-replies</code></span></dt><dd><p>Выводит сообщения, отправленные на имя используемой учётной записи.  Предположительно бесполезная
          функция.</p></dd><dt><span class="term"><code class="option">update-schedule</code></span></dt><dd><p>Собирает на Last.fm информацию о предстоящих концертах интересных исполнителей (имеющих дорожки с
          оценками выше средней) и сохраняет её в файл типа JavaScript, указанный в параметре
          <code class="option">event_schedule_path</code> конфигурационного файла; этот файл можно использовать для вывода карты на
          сайте.</p><p>Работает только при корректной настройке взаимодействия с Last.fm.</p></dd><dt><span class="term"><code class="option">update-track-lengths</code></span></dt><dd><p>Сверяет продолжительность файлов с информацией из базы данных и корректирует её.  Полезно запускать
          после ручного вмешательства в медиатеку.</p></dd><dt><span class="term"><code class="option">update-track-weights</code></span></dt><dd><p>Сдвигает текущий рейтинг каждой дорожки к реальному.  Вредная функция; описанная процедура выполняется
          автоматически при каждом проигрывании, ручной запуск только сбивает рейтинги.</p></dd><dt><span class="term"><code class="option">xmpp-send "message text" [jid]</code></span></dt><dd><p>Отправляет сообщение указанному пользователю или в чат, если пользователь не указан (название комнаты
          указывается в параметре <code class="option">jabber_chat_room</code> конфигурационного файла).</p></dd></dl></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="listening-statistics.html">Пред.</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="jabber-commands.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">Получение статистики </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> Приложение B. Описание команд jabber-бота</td></tr></table></div></body></html>
